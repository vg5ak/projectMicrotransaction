{% comment %}
/***************************************************************************************
*  REFERENCES
*  Title: In 5 mins: Set up Google login to sign up users on Django
*  Author: Zoe Chew
*  Date: 7/27/19
*  Code version: n/a
*  URL: https://medium.com/@whizzoe/in-5-mins-set-up-google-login-to-sign-up-users-on-django-e71d5c38f5d5
*  Software License: Not released under license, part of tutorial
*
***************************************************************************************/
{% endcomment %}

{% load socialaccount %}
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Google Registration</title>

    <!-- CSS only -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'microdollars/style.css' %}">

    <!-- JS, Popper.js, and jQuery for Bootstrap-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
  </head>
  <body class="bg-darkerlight">
    <!-- START HEADER -->
    <!-- First navbar row -->
    <div class="navbar navbar-default navbar-expand-md navbar-light bg-darkerlight">
      <div class="container">
        <a href="#" class="h1 navbar-brand nomargin">MicroDollars</a>
        {% if user.is_authenticated %}
          <!-- Sign out button -->
          <a class="btn btn-outline-danger pull-right" role="button" href="accounts/logout/">Logout</a>
        {% else %}
          <!-- Log in/Sign up button -->
          <a class="btn btn-outline-success pull-right" role="button" href="{% provider_login_url 'google' %}">Log in/Sign up with Google</a>
        {% endif %}
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </div>
    <!-- Second navbar row -->
    <div class="navbar navbar-default navbar-expand-md navbar-dark bg-success">
      <div class="container">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="navbar navbar-expand-md bg-light">
      <div class="container">
        {% if user.is_authenticated %}
        <p id="username" class="h1 navbar-brand nomargin">Welcome, {{ user.username }}!</p>
        {% else %}
        <p id="username" class="h1 navbar-brand nomargin">Not Logged In</p>
        {% endif %}
      </div>
    </div>
    <!-- STOP HEADER -->

    <!-- START PAGE CONTENT -->
    <div id="maincontent" class="container">
      <div class="col-sm">
      <br>
      <div class="row">
        <div class="col-md-12 bg-light padding rounded">

            {% for org in organizations %}
              <div class="orgcard-outer">
                <div class="orgcard-inner" id="{{ org.organization_name }}" onclick="changeOrgDropdown(this)"> <!-- background org image -->
                  <img class="orgcard-img" src="{{ org.image.url }}">
                  <h4 style="text-align: center;">{{ org.organization_name }}</h4>
                  <p style="padding: 4px;">{{ org.about_me }}</p>
                </div>
              </div>
            {% endfor %}



        </div>
      </div>
      <br>
      <div class="row">
        <div class="col-md-12 bg-light padding rounded">

            <form method="POST">
              {% csrf_token %}
              {{ form }}
              <button type="submit" class="btn btn-success">Donate!</button>
            </form>

        </div>
      </div>
      <br>
    </div>
    
    <div class="col-sm">
        {% for donation in donation_list%}
            <p>{{donation.amount}}</p>
        {% endfor %}
    </div>
    <br>


    </div>
    <!-- STOP PAGE CONTENT -->

    <!-- START FOOTER -->
    <footer class="font-small bg-darkblue text-darkerlight">
      <div class="footer-copyright text-center py-3">
        2020
        <b>2JV Team</b> (John Kim, Jami Park, Vinay Garimella, Vasil Zhigilei)
      </div>
    </footer>
    <!-- STOP FOOTER -->

    <script>
      function changeOrgDropdown(div) {
        var id = div.id; // get org name from clicked card id
        var dropdown = document.getElementById("id_donateto") // get dropdown
        var optionsLength = dropdown.options.length;
        for (var i = 0; i < optionsLength; i++){
          if (dropdown.options[i].text == id){
            dropdown.options[i].selected = true;
            break;
          }
        }
      }
    </script>
  </body>
</html>
